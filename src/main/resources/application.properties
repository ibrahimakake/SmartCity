# ==============================
# DATABASE CONFIGURATION
# ==============================
spring.datasource.url=jdbc:postgresql://localhost:5432/smartcity_db
spring.datasource.username=smartcity_user
spring.datasource.password=smartcity_pass
spring.datasource.driver-class-name=org.postgresql.Driver

# ==============================
# JPA / HIBERNATE CONFIGURATION
# ==============================

spring.jpa.hibernate.ddl-auto=update

# Affichage des requêtes SQL (désactiver en production)
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Logs SQL détaillés pour le débogage (désactiver en production)
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Configuration du fuseau horaire
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# ==============================
# SPRING DATA JPA AUDITING
# ==============================
# Configuration pour @CreatedDate et autres annotations d'audit
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false
spring.data.jpa.repositories.bootstrap-mode=default

# ==============================
# SPRING MVC / STATIC RESOURCES
# ==============================
spring.mvc.pathmatch.matching-strategy=ant_path_matcher
spring.web.resources.add-mappings=true
spring.web.resources.static-locations=classpath:/META-INF/resources/,classpath:/resources/,classpath:/static/,classpath:/public/,file:${user.dir}/frontend/frontend/

# ==============================
# SERVER CONFIGURATION
# ==============================
# Activation HTTP/2
server.http2.enabled=true

# Configuration de l'encodage
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# Compression des réponses HTTP
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# ==============================
# LOGGING CONFIGURATION
# ==============================
logging.level.org.springframework=INFO
logging.level.backend.backend=DEBUG

# ==============================
# H2 CONSOLE (DÉSACTIVÉ)
# ==============================
spring.h2.console.enabled=false

# ==============================
# JPA OPEN-IN-VIEW
# ==============================
# Désactiver pour éviter les problèmes de lazy loading dans les vues
spring.jpa.open-in-view=false

# ==============================
# BEAN OVERRIDING
# ==============================
# Permet l'écrasement de beans (nécessaire pour résoudre le conflit jpaAuditingHandler)
spring.main.allow-bean-definition-overriding=true

# Forcer Hibernate à utiliser le schéma public
spring.jpa.properties.hibernate.default_schema=public

# JWT Configuration
jwt.secret=your-256-bit-secret-change-this-in-production
jwt.expiration=86400000 # 24h
jwt.refresh-expiration=604800000 # 7d

# CORS Configuration
cors.allowed-origins=http://localhost:3000,http://localhost:8080
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true